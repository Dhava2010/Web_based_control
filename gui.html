<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4 Quadrant Box with HTML Table</title>
</head>
<body>
    <!--
    PURPOSE: Build a 2×2 grid layout (1920×1080) where only the top-right cell contains the D-pad.
             The other three cells are intentionally left blank for future widgets.
    -->
    <table width="1920" height="1080" style="border: 1px solid black;">
        <tr>
            <!-- Top-left quadrant – empty for now -->
            <td width="960" style="border: 1px solid black;"></td>

            <!-- Top-right quadrant – houses the remote-control D-pad -->
            <td height="540" style="border: 1px solid black;">
                <!--
                PURPOSE: Nest a smaller table that draws the 5-button D-pad.
                         The outer table only gives us the quadrant; this inner table
                         actually paints the arrows and the stop button.
                -->
                <table width="960" height="540">
                    <tr>
                        <td></td>
                        <!-- Up-arrow button -->
                        <td align="center" valign="middle" style="border: 1px solid black;">
                            <button type="button" style="font-size: 40px;" onclick="sendCommand('forward')">&uarr;</button>
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <!-- Left-arrow button -->
                        <td align="center" valign="middle" style="border: 1px solid black;">
                            <button type="button" style="font-size: 40px;" onclick="sendCommand('left')">&larr;</button>
                        </td>
                        <!-- Center cell: status icon + STOP button -->
                        <td align="center" valign="middle" style="border: 1px solid black;" width="320">
                            <button type="button" style="font-size: 45px;">&blacktriangleright;</button>
                            <button type="button" style="font-size: 40px;" onclick="sendCommand('stop')">&blacksquare;</button>
                        </td>
                        <!-- Right-arrow button -->
                        <td align="center" valign="middle" style="border: 1px solid black;">
                            <button type="button" style="font-size: 40px;" onclick="sendCommand('right')">&rarr;</button>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <!-- Down-arrow button -->
                        <td align="center" valign="middle" style="border: 1px solid black;">
                            <button type="button" style="font-size: 40px;" onclick="sendCommand('backward')">&darr;</button>
                        </td>
                        <td></td>
                    </tr>
                </table>
            </td>
        </tr>
        <!-- Bottom two quadrants – empty for future expansion -->
        <tr>
            <td style="border: 1px solid black;"></td>
            <td style="border: 1px solid black;"></td>
        </tr>
    </table>

    <script>
        /*
        PURPOSE: Send a single motion command to the Flask back-end.
        PARAMETERS:
            direction (string) – one of: 'forward', 'backward', 'left', 'right', 'stop'
        RETURNS: nothing (async side-effect only)
        SIDE-EFFECTS:
            - POSTs JSON {direction: <value>} to http://127.0.0.1:5000/controls
            - Logs success/failure to browser console
        */
        const API_URL = 'http://127.0.0.1:5000/controls ';
        async function sendCommand(direction) {
            console.log(`Attempting to send command: ${direction}`);

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ direction: direction })
                });

                if (response.ok) {
                    const result = await response.json();
                    console.log('Command successful. Robot direction:', result.direction);
                } else {
                    const errorText = await response.text();
                    console.error('Command failed. Status:', response.status, 'Error:', errorText);
                }
            } catch (error) {
                console.error('Network error during API call. Check if the Flask server is running:', error);
            }
        }

        /*
        PURPOSE: Let the user drive with the keyboard instead of clicking buttons.
        LISTENS FOR: keydown anywhere on the page
        MAPPED KEYS:
            ArrowUp    -> forward
            ArrowDown  -> backward
            ArrowLeft  -> left
            ArrowRight -> right
            Spacebar   -> stop
        PREVENTS: default browser behaviour (page scroll) for those keys
        RETURNS: nothing (fires sendCommand as side-effect)
        */
        window.addEventListener('keydown', (event) => {
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', ' '].includes(event.key)) {
                event.preventDefault();
            }

            let directionToSend = null;
            switch (event.key) {
                case 'ArrowUp':    directionToSend = 'forward';  break;
                case 'ArrowDown':  directionToSend = 'backward'; break;
                case 'ArrowLeft':  directionToSend = 'left';     break;
                case 'ArrowRight': directionToSend = 'right';    break;
                case ' ':          directionToSend = 'stop';     break;
                default:           return; // ignore every other key
            }

            if (directionToSend) sendCommand(directionToSend);
        });
    </script>
</body>
</html>

sudo apt install libopenblas0-pthread libpixman-1-0 libwayland-client0 libharfbuzz0b libva2 libgdk-pixbuf-2.0-0 libxcursor1 libnorm1 libspeex1 libdatrie1 libxinerama1 libdrm2 libva-x11-2 libssh-gcrypt-4 libwebpmux3 libavformat58 libgtk-3-0 libpangocairo-1.0-0 libgfortran5 libzmq5 libsnappy1v5 libdav1d4 libatspi2.0-0 libswresample3 libchromaprint1 libx264-160 libvdpau1 libxrender1 libshine3 librsvg2-2 libgme0 libxdamage1 libcairo-gobject2 libwavpack1 libvorbisfile3 libsodium23 libatk1.0-0 libwebpdemux2 libcairo2 libogg0 libxi6 libpangoft2-1.0-0 ocl-icd-libopencl1 libswscale5 libsoxr0 libatk-bridge2.0-0 libxkbcommon0 libxfixes3 libvpx6 libwayland-egl1 libvorbisenc2 libvorbis0a libbluray2 libtwolame0 libopenjp2-7 libzvbi0 libxcomposite1 libxrandr2 libavutil56 libatlas3-base libpango-1.0-0 libva-drm2 libxcb-render0 libepoxy0 libpgm-5.3-0 librabbitmq4 libmpg123-0 libwayland-cursor0 libopus0 libaom0 libcodec2-0.9 libgraphite2-3 libgsm1 libx265-192 libthai0 libsrt1.4-gnutls libavcodec58 libtheora0 libopenmpt0 libmp3lame0 libxvidcore4 libudfread0 libxcb-shm0
